// ===== [ ููุฏูุฉ ุงูุฅูุจุฑุงุทูุฑูุฉ ] =====
// ูููุน: El hardi Auto publish
// ุงููุทูุฑ: ุงูุฅูุจุฑุงุทูุฑ ุนุจุฏ ุงูุฑุญูููฐู ุงููุฑุฏู
// ูุตู: ุฃูุถู ูููุน ูู ุงูุชุงุฑูุฎ ููุดุฑ ุงููุญุชูู ุชููุงุฆููุง ุจุฎูุงุฑุฒููุงุช ุนุจูุฑูุฉ.


// ===== [ ุงุณุชุฏุนุงุก ุงูููุชุจุงุช ุงูุฃุณุงุณูุฉ ] =====
const express = require('express');
const bodyParser = require('body-parser');
const morgan = require('morgan');
const path = require('path');
const cors = require('cors');
const dotenv = require('dotenv');

// ===== [ ุชุญููู ุฅุนุฏุงุฏุงุช ุงูุจูุฆุฉ ูู ููู .env ] =====
dotenv.config();

// ===== [ ุฅูุดุงุก ุงูุชุทุจูู ุงูุฑุฆูุณู ุจุงุณุชุฎุฏุงู Express ] =====
const app = express();

// ===== [ ุฅุนุฏุงุฏ ุงููููุฐ ุงูุฃุณุงุณู ููุชุทุจูู ] =====
const PORT = process.env.PORT || 3000;

// ===== [ ุชูููู ุงูู Middleware ] =====
app.use(bodyParser.json()); // ูุชุญููู ุจูุงูุงุช JSON ุงููุงุฏูุฉ ูู ุงูุทูุจุงุช
app.use(bodyParser.urlencoded({ extended: true })); // ูุชุญููู ุงูุจูุงูุงุช ุงููุดูุฑุฉ URL Encoded
app.use(morgan('dev')); // ุชุณุฌูู ุงูุทูุจุงุช ูุชุณููู ูุฑุงูุจุฉ ุงูุฃุฏุงุก
app.use(cors()); // ุงูุณูุงุญ ุจุงูุทูุจุงุช ูู ุฃุตูู ูุฎุชููุฉ (ููู ููุฏูุฌ ูุน ุงูุชุทุจููุงุช ุงูุฃุฎุฑู)
app.use(express.static(path.join(__dirname, '../assets'))); // ูุฎุฏูุฉ ุงููููุงุช ุงูุซุงุจุชุฉ (CSSุ JS)

// ===== [ ุฑุณุงูุฉ ุชุฑุญูุจูุฉ ุนูุฏ ุงููุตูู ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ] =====
app.get('/', (req, res) => {
    res.status(200).send(`
        <div style="font-family: Arial, sans-serif; text-align: center; margin-top: 50px;">
            <h1 style="color: #1e90ff;">ูุฑุญุจูุง ุจู ูู ุงูุฅูุจุฑุงุทูุฑูุฉ El hardi Auto publish</h1>
            <p style="color: #333;">ุงููููุน ุงูุฐู ุณูุซูุฑ ุนุงูู ุงููุดุฑ ุงูุชููุงุฆู ุจููุงุฏุฉ <strong>ุงูุฅูุจุฑุงุทูุฑ ุนุจุฏ ุงูุฑุญูููฐู ุงููุฑุฏู</strong>.</p>
            <p style="color: #777;">ุงูุชุดู ููุฉ ุงูุจุฑูุฌูุงุชุ ููู ุฌุฒุกูุง ูู ูุฐู ุงูุฑุญูุฉ ุงูุนุธููุฉ.</p>
        </div>
    `);
});

// ===== [ ูุณุงุฑุงุช API ุงููุฎุตุตุฉ ] =====
const youtubeRoutes = require('./routes/youtube'); // ูุณุงุฑุงุช ุฌูุจ ูุญุชูู YouTube
const otherRoutes = require('./routes/other'); // ูุณุงุฑุงุช ุฃุฎุฑู ูุฏ ูุถูููุง ูุงุญููุง
app.use('/api/youtube', youtubeRoutes); // ูุชุฎุตูุต ูุณุงุฑ YouTube API
app.use('/api/other', otherRoutes); // ูููุณุชูุจู

// ===== [ ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก: 404 Not Found ] =====
app.use((req, res, next) => {
    res.status(404).send(`
        <div style="font-family: Arial, sans-serif; text-align: center; margin-top: 50px;">
            <h1 style="color: red;">ุฎุทุฃ 404</h1>
            <p style="color: #333;">ุนุฐุฑูุงุ ุงูุตูุญุฉ ุงูุชู ุชุจุญุซ ุนููุง ุบูุฑ ููุฌูุฏุฉ!</p>
        </div>
    `);
});

// ===== [ ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ุงูุนุงูุฉ ] =====
app.use((err, req, res, next) => {
    console.error(`[ุฎุทุฃ] ${err.message}`);
    res.status(500).send({
        error: true,
        message: "ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน! ูุฑูููุง ูุนูู ุนูู ุฅุตูุงุญู."
    });
});

// ===== [ ุชุดุบูู ุงูุณูุฑูุฑ ูุฅุธูุงุฑ ุฑุณุงูุฉ ุจุฏุก ุงูุชุดุบูู ] =====
app.listen(PORT, () => {
    console.log(`โจ ุงูุณูุฑูุฑ ูุนูู ุงูุขู ุนูู: http://localhost:${PORT}`);
    console.log(`
        =====================================================
        ๐ ูุฑุญุจูุง ุจู ูู ุงูุฅูุจุฑุงุทูุฑูุฉ El hardi Auto publish
        ุงููุทูุฑ: ุงูุฅูุจุฑุงุทูุฑ ุนุจุฏ ุงูุฑุญูููฐู ุงููุฑุฏู
        ุงููุตู: ุฃูุถู ูููุน ููุดุฑ ุงููุญุชูู ุงูุชููุงุฆู ุจุฎูุงุฑุฒููุงุช ุฃุณุทูุฑูุฉ.
        =====================================================
    `);
});